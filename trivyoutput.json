{
  "SchemaVersion": 2,
  "CreatedAt": "2025-12-04T17:22:51.24766354-05:00",
  "ArtifactName": ".",
  "ArtifactType": "filesystem",
  "Metadata": {
    "ImageConfig": {
      "architecture": "",
      "created": "0001-01-01T00:00:00Z",
      "os": "",
      "rootfs": {
        "type": "",
        "diff_ids": null
      },
      "config": {}
    }
  },
  "Results": [
    {
      "Target": "lab4-template-1764886068528.yaml",
      "Class": "config",
      "Type": "cloudformation",
      "MisconfSummary": {
        "Successes": 42,
        "Failures": 22,
        "Exceptions": 0
      },
      "Misconfigurations": [
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0015",
          "AVDID": "AVD-AWS-0015",
          "Title": "CloudTrail should use Customer managed keys to encrypt the logs",
          "Description": "Using Customer managed keys provides comprehensive control over cryptographic keys, enabling management of policies, permissions, and rotation, thus enhancing security and compliance measures for sensitive data and systems.",
          "Message": "CloudTrail does not use a customer managed key to encrypt the logs.",
          "Query": "data..",
          "Resolution": "Use Customer managed key",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0015",
          "References": [
            "https://docs.aws.amazon.com/awscloudtrail/latest/userguide/encrypting-cloudtrail-log-files-with-aws-kms.html",
            "https://docs.aws.amazon.com/kms/latest/developerguide/concepts.html#key-mgmt",
            "https://avd.aquasec.com/misconfig/avd-aws-0015"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "lab4-template-1764886068528.yaml:392-416",
            "Provider": "AWS",
            "Service": "cloudtrail",
            "StartLine": 392,
            "EndLine": 416,
            "Code": {
              "Lines": [
                {
                  "Number": 392,
                  "Content": "  CloudTrailTrailLab4S3modficationsTrail:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;33mCloudTrailTrailLab4S3modficationsTrail\u001b[0m:",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 393,
                  "Content": "    UpdateReplacePolicy: \"Retain\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mUpdateReplacePolicy\u001b[0m: \u001b[38;5;37m\"Retain\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 394,
                  "Content": "    Type: \"AWS::CloudTrail::Trail\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;33mType\u001b[0m: \u001b[38;5;37m\"AWS::CloudTrail::Trail\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 395,
                  "Content": "    DeletionPolicy: \"Retain\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;33mDeletionPolicy\u001b[0m: \u001b[38;5;37m\"Retain\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 396,
                  "Content": "    Properties:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;33mProperties\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 397,
                  "Content": "      IncludeGlobalServiceEvents: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mIncludeGlobalServiceEvents\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 398,
                  "Content": "      EventSelectors:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mEventSelectors\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 399,
                  "Content": "      - IncludeManagementEvents: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mIncludeManagementEvents\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 400,
                  "Content": "        DataResources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mDataResources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 401,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "s3-bucket-logging",
          "AVDID": "AVD-AWS-0089",
          "Title": "S3 Bucket Logging",
          "Description": "Ensures S3 bucket logging is enabled for S3 buckets",
          "Message": "Bucket has logging disabled",
          "Namespace": "builtin.aws.s3.aws0089",
          "Query": "data.builtin.aws.s3.aws0089.deny",
          "Resolution": "Add a logging block to the resource to enable access logging",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/s3-bucket-logging",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/ServerLogs.html",
            "https://avd.aquasec.com/misconfig/s3-bucket-logging"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "lab4-template-1764886068528.yaml:295-336",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 295,
            "EndLine": 336,
            "Code": {
              "Lines": [
                {
                  "Number": 295,
                  "Content": "  S3BucketPolystudent3pylab4try2:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;33mS3BucketPolystudent3pylab4try2\u001b[0m:",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 296,
                  "Content": "    UpdateReplacePolicy: \"Retain\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mUpdateReplacePolicy\u001b[0m: \u001b[38;5;37m\"Retain\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 297,
                  "Content": "    Type: \"AWS::S3::Bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;33mType\u001b[0m: \u001b[38;5;37m\"AWS::S3::Bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 298,
                  "Content": "    DeletionPolicy: \"Retain\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;33mDeletionPolicy\u001b[0m: \u001b[38;5;37m\"Retain\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 299,
                  "Content": "    Properties:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;33mProperties\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 300,
                  "Content": "      AbacStatus: \"Disabled\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mAbacStatus\u001b[0m: \u001b[38;5;37m\"Disabled\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 301,
                  "Content": "      PublicAccessBlockConfiguration:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mPublicAccessBlockConfiguration\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 302,
                  "Content": "        RestrictPublicBuckets: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mRestrictPublicBuckets\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 303,
                  "Content": "        IgnorePublicAcls: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mIgnorePublicAcls\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 304,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "s3-bucket-logging",
          "AVDID": "AVD-AWS-0089",
          "Title": "S3 Bucket Logging",
          "Description": "Ensures S3 bucket logging is enabled for S3 buckets",
          "Message": "Bucket has logging disabled",
          "Namespace": "builtin.aws.s3.aws0089",
          "Query": "data.builtin.aws.s3.aws0089.deny",
          "Resolution": "Add a logging block to the resource to enable access logging",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/s3-bucket-logging",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/ServerLogs.html",
            "https://avd.aquasec.com/misconfig/s3-bucket-logging"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "lab4-template-1764886068528.yaml:366-391",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 366,
            "EndLine": 391,
            "Code": {
              "Lines": [
                {
                  "Number": 366,
                  "Content": "  S3BucketPolystudent3pylab4try2back:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;33mS3BucketPolystudent3pylab4try2back\u001b[0m:",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 367,
                  "Content": "    UpdateReplacePolicy: \"Retain\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mUpdateReplacePolicy\u001b[0m: \u001b[38;5;37m\"Retain\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 368,
                  "Content": "    Type: \"AWS::S3::Bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;33mType\u001b[0m: \u001b[38;5;37m\"AWS::S3::Bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 369,
                  "Content": "    DeletionPolicy: \"Retain\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;33mDeletionPolicy\u001b[0m: \u001b[38;5;37m\"Retain\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 370,
                  "Content": "    Properties:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;33mProperties\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 371,
                  "Content": "      AbacStatus: \"Disabled\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mAbacStatus\u001b[0m: \u001b[38;5;37m\"Disabled\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 372,
                  "Content": "      PublicAccessBlockConfiguration:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mPublicAccessBlockConfiguration\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 373,
                  "Content": "        RestrictPublicBuckets: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mRestrictPublicBuckets\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 374,
                  "Content": "        IgnorePublicAcls: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mIgnorePublicAcls\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 375,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0104",
          "AVDID": "AVD-AWS-0104",
          "Title": "An egress security group rule allows traffic to /0.",
          "Description": "Opening up ports to connect out to the public internet is generally to be avoided. You should restrict access to IP addresses or ranges that are explicitly required where possible.",
          "Message": "Security group rule allows egress to multiple public internet addresses.",
          "Query": "data..",
          "Resolution": "Set a more restrictive cidr range",
          "Severity": "CRITICAL",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0104",
          "References": [
            "https://docs.aws.amazon.com/whitepapers/latest/building-scalable-secure-multi-vpc-network-infrastructure/centralized-egress-to-internet.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0104"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "EC2SecurityGroup",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 109,
            "EndLine": 109,
            "Code": {
              "Lines": [
                {
                  "Number": 90,
                  "Content": "  EC2SecurityGroup:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;33mEC2SecurityGroup\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 91,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 109,
                  "Content": "      - CidrIp: \"0.0.0.0/0\"",
                  "IsCause": true,
                  "Annotation": "\"0.0.0.0/0\"",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mCidrIp\u001b[0m: \u001b[38;5;37m\"0.0.0.0/0\"",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 111,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 112,
                  "Content": "        ToPort: -1",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mToPort\u001b[0m: -\u001b[38;5;37m1",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "EC2SecurityGroup",
                "Filename": "lab4-template-1764886068528.yaml",
                "Location": {
                  "StartLine": 90,
                  "EndLine": 112
                }
              }
            ]
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0104",
          "AVDID": "AVD-AWS-0104",
          "Title": "An egress security group rule allows traffic to /0.",
          "Description": "Opening up ports to connect out to the public internet is generally to be avoided. You should restrict access to IP addresses or ranges that are explicitly required where possible.",
          "Message": "Security group rule allows egress to multiple public internet addresses.",
          "Query": "data..",
          "Resolution": "Set a more restrictive cidr range",
          "Severity": "CRITICAL",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0104",
          "References": [
            "https://docs.aws.amazon.com/whitepapers/latest/building-scalable-secure-multi-vpc-network-infrastructure/centralized-egress-to-internet.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0104"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "EC2SecurityGroupHV",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 254,
            "EndLine": 254,
            "Code": {
              "Lines": [
                {
                  "Number": 188,
                  "Content": "  EC2SecurityGroupHV:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;33mEC2SecurityGroupHV\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 189,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 254,
                  "Content": "      - CidrIp: \"0.0.0.0/0\"",
                  "IsCause": true,
                  "Annotation": "\"0.0.0.0/0\"",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mCidrIp\u001b[0m: \u001b[38;5;37m\"0.0.0.0/0\"",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 256,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 257,
                  "Content": "        ToPort: -1",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mToPort\u001b[0m: -\u001b[38;5;37m1",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "EC2SecurityGroupHV",
                "Filename": "lab4-template-1764886068528.yaml",
                "Location": {
                  "StartLine": 188,
                  "EndLine": 257
                }
              }
            ]
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0107",
          "AVDID": "AVD-AWS-0107",
          "Title": "An ingress security group rule allows traffic from /0.",
          "Description": "Opening up ports to the public internet is generally to be avoided. You should restrict access to IP addresses or ranges that explicitly require it where possible.",
          "Message": "Security group rule allows ingress from public internet.",
          "Query": "data..",
          "Resolution": "Set a more restrictive cidr range",
          "Severity": "CRITICAL",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0107",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/security-group-rules-reference.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0107"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "EC2SecurityGroupHV",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 243,
            "EndLine": 243,
            "Code": {
              "Lines": [
                {
                  "Number": 188,
                  "Content": "  EC2SecurityGroupHV:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;33mEC2SecurityGroupHV\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 189,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 243,
                  "Content": "      - CidrIp: \"0.0.0.0/0\"",
                  "IsCause": true,
                  "Annotation": "\"0.0.0.0/0\"",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      - \u001b[38;5;33mCidrIp\u001b[0m: \u001b[38;5;37m\"0.0.0.0/0\"",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 256,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 257,
                  "Content": "        ToPort: -1",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mToPort\u001b[0m: -\u001b[38;5;37m1",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "EC2SecurityGroupHV",
                "Filename": "lab4-template-1764886068528.yaml",
                "Location": {
                  "StartLine": 188,
                  "EndLine": 257
                }
              }
            ]
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0107",
          "AVDID": "AVD-AWS-0107",
          "Title": "An ingress security group rule allows traffic from /0.",
          "Description": "Opening up ports to the public internet is generally to be avoided. You should restrict access to IP addresses or ranges that explicitly require it where possible.",
          "Message": "Security group rule allows ingress from public internet.",
          "Query": "data..",
          "Resolution": "Set a more restrictive cidr range",
          "Severity": "CRITICAL",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0107",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/security-group-rules-reference.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0107"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "EC2SecurityGroupHV",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 203,
            "EndLine": 203,
            "Code": {
              "Lines": [
                {
                  "Number": 188,
                  "Content": "  EC2SecurityGroupHV:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;33mEC2SecurityGroupHV\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 189,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 203,
                  "Content": "      - CidrIp: \"0.0.0.0/0\"",
                  "IsCause": true,
                  "Annotation": "\"0.0.0.0/0\"",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      - \u001b[38;5;33mCidrIp\u001b[0m: \u001b[38;5;37m\"0.0.0.0/0\"",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 256,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 257,
                  "Content": "        ToPort: -1",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mToPort\u001b[0m: -\u001b[38;5;37m1",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "EC2SecurityGroupHV",
                "Filename": "lab4-template-1764886068528.yaml",
                "Location": {
                  "StartLine": 188,
                  "EndLine": 257
                }
              }
            ]
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0107",
          "AVDID": "AVD-AWS-0107",
          "Title": "An ingress security group rule allows traffic from /0.",
          "Description": "Opening up ports to the public internet is generally to be avoided. You should restrict access to IP addresses or ranges that explicitly require it where possible.",
          "Message": "Security group rule allows ingress from public internet.",
          "Query": "data..",
          "Resolution": "Set a more restrictive cidr range",
          "Severity": "CRITICAL",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0107",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/security-group-rules-reference.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0107"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "EC2SecurityGroupHV",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 218,
            "EndLine": 218,
            "Code": {
              "Lines": [
                {
                  "Number": 188,
                  "Content": "  EC2SecurityGroupHV:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;33mEC2SecurityGroupHV\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 189,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 218,
                  "Content": "      - CidrIp: \"0.0.0.0/0\"",
                  "IsCause": true,
                  "Annotation": "\"0.0.0.0/0\"",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      - \u001b[38;5;33mCidrIp\u001b[0m: \u001b[38;5;37m\"0.0.0.0/0\"",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 256,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 257,
                  "Content": "        ToPort: -1",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mToPort\u001b[0m: -\u001b[38;5;37m1",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "EC2SecurityGroupHV",
                "Filename": "lab4-template-1764886068528.yaml",
                "Location": {
                  "StartLine": 188,
                  "EndLine": 257
                }
              }
            ]
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0107",
          "AVDID": "AVD-AWS-0107",
          "Title": "An ingress security group rule allows traffic from /0.",
          "Description": "Opening up ports to the public internet is generally to be avoided. You should restrict access to IP addresses or ranges that explicitly require it where possible.",
          "Message": "Security group rule allows ingress from public internet.",
          "Query": "data..",
          "Resolution": "Set a more restrictive cidr range",
          "Severity": "CRITICAL",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0107",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/security-group-rules-reference.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0107"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "EC2SecurityGroupHV",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 223,
            "EndLine": 223,
            "Code": {
              "Lines": [
                {
                  "Number": 188,
                  "Content": "  EC2SecurityGroupHV:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;33mEC2SecurityGroupHV\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 189,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 223,
                  "Content": "      - CidrIp: \"0.0.0.0/0\"",
                  "IsCause": true,
                  "Annotation": "\"0.0.0.0/0\"",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      - \u001b[38;5;33mCidrIp\u001b[0m: \u001b[38;5;37m\"0.0.0.0/0\"",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 256,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 257,
                  "Content": "        ToPort: -1",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mToPort\u001b[0m: -\u001b[38;5;37m1",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "EC2SecurityGroupHV",
                "Filename": "lab4-template-1764886068528.yaml",
                "Location": {
                  "StartLine": 188,
                  "EndLine": 257
                }
              }
            ]
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0107",
          "AVDID": "AVD-AWS-0107",
          "Title": "An ingress security group rule allows traffic from /0.",
          "Description": "Opening up ports to the public internet is generally to be avoided. You should restrict access to IP addresses or ranges that explicitly require it where possible.",
          "Message": "Security group rule allows ingress from public internet.",
          "Query": "data..",
          "Resolution": "Set a more restrictive cidr range",
          "Severity": "CRITICAL",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0107",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/security-group-rules-reference.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0107"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "EC2SecurityGroupHV",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 228,
            "EndLine": 228,
            "Code": {
              "Lines": [
                {
                  "Number": 188,
                  "Content": "  EC2SecurityGroupHV:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;33mEC2SecurityGroupHV\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 189,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 228,
                  "Content": "      - CidrIp: \"0.0.0.0/0\"",
                  "IsCause": true,
                  "Annotation": "\"0.0.0.0/0\"",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      - \u001b[38;5;33mCidrIp\u001b[0m: \u001b[38;5;37m\"0.0.0.0/0\"",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 256,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 257,
                  "Content": "        ToPort: -1",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mToPort\u001b[0m: -\u001b[38;5;37m1",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "EC2SecurityGroupHV",
                "Filename": "lab4-template-1764886068528.yaml",
                "Location": {
                  "StartLine": 188,
                  "EndLine": 257
                }
              }
            ]
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0107",
          "AVDID": "AVD-AWS-0107",
          "Title": "An ingress security group rule allows traffic from /0.",
          "Description": "Opening up ports to the public internet is generally to be avoided. You should restrict access to IP addresses or ranges that explicitly require it where possible.",
          "Message": "Security group rule allows ingress from public internet.",
          "Query": "data..",
          "Resolution": "Set a more restrictive cidr range",
          "Severity": "CRITICAL",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0107",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/security-group-rules-reference.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0107"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "EC2SecurityGroupHV",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 233,
            "EndLine": 233,
            "Code": {
              "Lines": [
                {
                  "Number": 188,
                  "Content": "  EC2SecurityGroupHV:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;33mEC2SecurityGroupHV\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 189,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 233,
                  "Content": "      - CidrIp: \"0.0.0.0/0\"",
                  "IsCause": true,
                  "Annotation": "\"0.0.0.0/0\"",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      - \u001b[38;5;33mCidrIp\u001b[0m: \u001b[38;5;37m\"0.0.0.0/0\"",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 256,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 257,
                  "Content": "        ToPort: -1",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mToPort\u001b[0m: -\u001b[38;5;37m1",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "EC2SecurityGroupHV",
                "Filename": "lab4-template-1764886068528.yaml",
                "Location": {
                  "StartLine": 188,
                  "EndLine": 257
                }
              }
            ]
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0107",
          "AVDID": "AVD-AWS-0107",
          "Title": "An ingress security group rule allows traffic from /0.",
          "Description": "Opening up ports to the public internet is generally to be avoided. You should restrict access to IP addresses or ranges that explicitly require it where possible.",
          "Message": "Security group rule allows ingress from public internet.",
          "Query": "data..",
          "Resolution": "Set a more restrictive cidr range",
          "Severity": "CRITICAL",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0107",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/security-group-rules-reference.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0107"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "EC2SecurityGroupHV",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 238,
            "EndLine": 238,
            "Code": {
              "Lines": [
                {
                  "Number": 188,
                  "Content": "  EC2SecurityGroupHV:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;33mEC2SecurityGroupHV\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 189,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 238,
                  "Content": "      - CidrIp: \"0.0.0.0/0\"",
                  "IsCause": true,
                  "Annotation": "\"0.0.0.0/0\"",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      - \u001b[38;5;33mCidrIp\u001b[0m: \u001b[38;5;37m\"0.0.0.0/0\"",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 256,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 257,
                  "Content": "        ToPort: -1",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mToPort\u001b[0m: -\u001b[38;5;37m1",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "EC2SecurityGroupHV",
                "Filename": "lab4-template-1764886068528.yaml",
                "Location": {
                  "StartLine": 188,
                  "EndLine": 257
                }
              }
            ]
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0107",
          "AVDID": "AVD-AWS-0107",
          "Title": "An ingress security group rule allows traffic from /0.",
          "Description": "Opening up ports to the public internet is generally to be avoided. You should restrict access to IP addresses or ranges that explicitly require it where possible.",
          "Message": "Security group rule allows ingress from public internet.",
          "Query": "data..",
          "Resolution": "Set a more restrictive cidr range",
          "Severity": "CRITICAL",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0107",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/security-group-rules-reference.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0107"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "EC2SecurityGroupHV",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 208,
            "EndLine": 208,
            "Code": {
              "Lines": [
                {
                  "Number": 188,
                  "Content": "  EC2SecurityGroupHV:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;33mEC2SecurityGroupHV\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 189,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 208,
                  "Content": "      - CidrIp: \"0.0.0.0/0\"",
                  "IsCause": true,
                  "Annotation": "\"0.0.0.0/0\"",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      - \u001b[38;5;33mCidrIp\u001b[0m: \u001b[38;5;37m\"0.0.0.0/0\"",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 256,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 257,
                  "Content": "        ToPort: -1",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mToPort\u001b[0m: -\u001b[38;5;37m1",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "EC2SecurityGroupHV",
                "Filename": "lab4-template-1764886068528.yaml",
                "Location": {
                  "StartLine": 188,
                  "EndLine": 257
                }
              }
            ]
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0107",
          "AVDID": "AVD-AWS-0107",
          "Title": "An ingress security group rule allows traffic from /0.",
          "Description": "Opening up ports to the public internet is generally to be avoided. You should restrict access to IP addresses or ranges that explicitly require it where possible.",
          "Message": "Security group rule allows ingress from public internet.",
          "Query": "data..",
          "Resolution": "Set a more restrictive cidr range",
          "Severity": "CRITICAL",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0107",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/security-group-rules-reference.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0107"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "EC2SecurityGroupHV",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 248,
            "EndLine": 248,
            "Code": {
              "Lines": [
                {
                  "Number": 188,
                  "Content": "  EC2SecurityGroupHV:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;33mEC2SecurityGroupHV\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 189,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 248,
                  "Content": "      - CidrIp: \"0.0.0.0/0\"",
                  "IsCause": true,
                  "Annotation": "\"0.0.0.0/0\"",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      - \u001b[38;5;33mCidrIp\u001b[0m: \u001b[38;5;37m\"0.0.0.0/0\"",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 256,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 257,
                  "Content": "        ToPort: -1",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mToPort\u001b[0m: -\u001b[38;5;37m1",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "EC2SecurityGroupHV",
                "Filename": "lab4-template-1764886068528.yaml",
                "Location": {
                  "StartLine": 188,
                  "EndLine": 257
                }
              }
            ]
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0107",
          "AVDID": "AVD-AWS-0107",
          "Title": "An ingress security group rule allows traffic from /0.",
          "Description": "Opening up ports to the public internet is generally to be avoided. You should restrict access to IP addresses or ranges that explicitly require it where possible.",
          "Message": "Security group rule allows ingress from public internet.",
          "Query": "data..",
          "Resolution": "Set a more restrictive cidr range",
          "Severity": "CRITICAL",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0107",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/security-group-rules-reference.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0107"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "EC2SecurityGroupHV",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 213,
            "EndLine": 213,
            "Code": {
              "Lines": [
                {
                  "Number": 188,
                  "Content": "  EC2SecurityGroupHV:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;33mEC2SecurityGroupHV\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 189,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 213,
                  "Content": "      - CidrIp: \"0.0.0.0/0\"",
                  "IsCause": true,
                  "Annotation": "\"0.0.0.0/0\"",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      - \u001b[38;5;33mCidrIp\u001b[0m: \u001b[38;5;37m\"0.0.0.0/0\"",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 256,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 257,
                  "Content": "        ToPort: -1",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mToPort\u001b[0m: -\u001b[38;5;37m1",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "EC2SecurityGroupHV",
                "Filename": "lab4-template-1764886068528.yaml",
                "Location": {
                  "StartLine": 188,
                  "EndLine": 257
                }
              }
            ]
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0107",
          "AVDID": "AVD-AWS-0107",
          "Title": "An ingress security group rule allows traffic from /0.",
          "Description": "Opening up ports to the public internet is generally to be avoided. You should restrict access to IP addresses or ranges that explicitly require it where possible.",
          "Message": "Security group rule allows ingress from public internet.",
          "Query": "data..",
          "Resolution": "Set a more restrictive cidr range",
          "Severity": "CRITICAL",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0107",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/security-group-rules-reference.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0107"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "EC2SecurityGroupHV",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 198,
            "EndLine": 198,
            "Code": {
              "Lines": [
                {
                  "Number": 188,
                  "Content": "  EC2SecurityGroupHV:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;33mEC2SecurityGroupHV\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 189,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 198,
                  "Content": "      - CidrIp: \"0.0.0.0/0\"",
                  "IsCause": true,
                  "Annotation": "\"0.0.0.0/0\"",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mCidrIp\u001b[0m: \u001b[38;5;37m\"0.0.0.0/0\"",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 256,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 257,
                  "Content": "        ToPort: -1",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mToPort\u001b[0m: -\u001b[38;5;37m1",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "EC2SecurityGroupHV",
                "Filename": "lab4-template-1764886068528.yaml",
                "Location": {
                  "StartLine": 188,
                  "EndLine": 257
                }
              }
            ]
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0124",
          "AVDID": "AVD-AWS-0124",
          "Title": "Missing description for security group rule.",
          "Description": "Security group rules should include a description for auditing purposes.\n\nSimplifies auditing, debugging, and managing security groups.",
          "Message": "Security group rule does not have a description.",
          "Query": "data..",
          "Resolution": "Add descriptions for all security groups rules",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0124",
          "References": [
            "https://www.cloudconformity.com/knowledge-base/aws/EC2/security-group-rules-description.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0124"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "EC2SecurityGroup",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 109,
            "EndLine": 112,
            "Code": {
              "Lines": [
                {
                  "Number": 90,
                  "Content": "  EC2SecurityGroup:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;33mEC2SecurityGroup\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 91,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 109,
                  "Content": "      - CidrIp: \"0.0.0.0/0\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mCidrIp\u001b[0m: \u001b[38;5;37m\"0.0.0.0/0\"",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 110,
                  "Content": "        IpProtocol: \"-1\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mIpProtocol\u001b[0m: \u001b[38;5;37m\"-1\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 111,
                  "Content": "        FromPort: -1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mFromPort\u001b[0m: -\u001b[38;5;37m1",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 112,
                  "Content": "        ToPort: -1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mToPort\u001b[0m: -\u001b[38;5;37m1",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "EC2SecurityGroup",
                "Filename": "lab4-template-1764886068528.yaml",
                "Location": {
                  "StartLine": 90,
                  "EndLine": 112
                }
              }
            ]
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0124",
          "AVDID": "AVD-AWS-0124",
          "Title": "Missing description for security group rule.",
          "Description": "Security group rules should include a description for auditing purposes.\n\nSimplifies auditing, debugging, and managing security groups.",
          "Message": "Security group rule does not have a description.",
          "Query": "data..",
          "Resolution": "Add descriptions for all security groups rules",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0124",
          "References": [
            "https://www.cloudconformity.com/knowledge-base/aws/EC2/security-group-rules-description.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0124"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "EC2SecurityGroup",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 100,
            "EndLine": 107,
            "Code": {
              "Lines": [
                {
                  "Number": 90,
                  "Content": "  EC2SecurityGroup:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;33mEC2SecurityGroup\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 91,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 100,
                  "Content": "      - IpProtocol: \"-1\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mIpProtocol\u001b[0m: \u001b[38;5;37m\"-1\"",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 101,
                  "Content": "        FromPort: -1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mFromPort\u001b[0m: -\u001b[38;5;37m1",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 102,
                  "Content": "        SourceSecurityGroupId:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mSourceSecurityGroupId\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 103,
                  "Content": "          Fn::GetAtt:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mFn::GetAtt\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 104,
                  "Content": "          - \"EC2VPC\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          - \u001b[38;5;37m\"EC2VPC\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 105,
                  "Content": "          - \"DefaultSecurityGroup\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          - \u001b[38;5;37m\"DefaultSecurityGroup\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 106,
                  "Content": "        ToPort: -1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mToPort\u001b[0m: -\u001b[38;5;37m1",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 107,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "EC2SecurityGroup",
                "Filename": "lab4-template-1764886068528.yaml",
                "Location": {
                  "StartLine": 90,
                  "EndLine": 112
                }
              }
            ]
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0124",
          "AVDID": "AVD-AWS-0124",
          "Title": "Missing description for security group rule.",
          "Description": "Security group rules should include a description for auditing purposes.\n\nSimplifies auditing, debugging, and managing security groups.",
          "Message": "Security group rule does not have a description.",
          "Query": "data..",
          "Resolution": "Add descriptions for all security groups rules",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0124",
          "References": [
            "https://www.cloudconformity.com/knowledge-base/aws/EC2/security-group-rules-description.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0124"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "EC2SecurityGroupHV",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 254,
            "EndLine": 257,
            "Code": {
              "Lines": [
                {
                  "Number": 188,
                  "Content": "  EC2SecurityGroupHV:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;33mEC2SecurityGroupHV\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 189,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 254,
                  "Content": "      - CidrIp: \"0.0.0.0/0\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mCidrIp\u001b[0m: \u001b[38;5;37m\"0.0.0.0/0\"",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 255,
                  "Content": "        IpProtocol: \"-1\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mIpProtocol\u001b[0m: \u001b[38;5;37m\"-1\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 256,
                  "Content": "        FromPort: -1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mFromPort\u001b[0m: -\u001b[38;5;37m1",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 257,
                  "Content": "        ToPort: -1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mToPort\u001b[0m: -\u001b[38;5;37m1",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "EC2SecurityGroupHV",
                "Filename": "lab4-template-1764886068528.yaml",
                "Location": {
                  "StartLine": 188,
                  "EndLine": 257
                }
              }
            ]
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0162",
          "AVDID": "AVD-AWS-0162",
          "Title": "CloudTrail logs should be stored in S3 and also sent to CloudWatch Logs",
          "Description": "\nCloudTrail is a web service that records AWS API calls made in a given account. The recorded information includes the identity of the API caller, the time of the API call, the source IP address of the API caller, the request parameters, and the response elements returned by the AWS service.\n\nCloudTrail uses Amazon S3 for log file storage and delivery, so log files are stored durably. In addition to capturing CloudTrail logs in a specified Amazon S3 bucket for long-term analysis, you can perform real-time analysis by configuring CloudTrail to send logs to CloudWatch Logs.\n\nFor a trail that is enabled in all Regions in an account, CloudTrail sends log files from all those Regions to a CloudWatch Logs log group.\n",
          "Message": "Trail does not have CloudWatch logging configured",
          "Query": "data..",
          "Resolution": "Enable logging to CloudWatch",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0162",
          "References": [
            "https://docs.aws.amazon.com/awscloudtrail/latest/userguide/send-cloudtrail-events-to-cloudwatch-logs.html#send-cloudtrail-events-to-cloudwatch-logs-console",
            "https://avd.aquasec.com/misconfig/avd-aws-0162"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "lab4-template-1764886068528.yaml:392-416",
            "Provider": "AWS",
            "Service": "cloudtrail",
            "StartLine": 392,
            "EndLine": 416,
            "Code": {
              "Lines": [
                {
                  "Number": 392,
                  "Content": "  CloudTrailTrailLab4S3modficationsTrail:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;33mCloudTrailTrailLab4S3modficationsTrail\u001b[0m:",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 393,
                  "Content": "    UpdateReplacePolicy: \"Retain\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mUpdateReplacePolicy\u001b[0m: \u001b[38;5;37m\"Retain\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 394,
                  "Content": "    Type: \"AWS::CloudTrail::Trail\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;33mType\u001b[0m: \u001b[38;5;37m\"AWS::CloudTrail::Trail\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 395,
                  "Content": "    DeletionPolicy: \"Retain\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;33mDeletionPolicy\u001b[0m: \u001b[38;5;37m\"Retain\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 396,
                  "Content": "    Properties:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;33mProperties\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 397,
                  "Content": "      IncludeGlobalServiceEvents: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mIncludeGlobalServiceEvents\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 398,
                  "Content": "      EventSelectors:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mEventSelectors\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 399,
                  "Content": "      - IncludeManagementEvents: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mIncludeManagementEvents\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 400,
                  "Content": "        DataResources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mDataResources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 401,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0164",
          "AVDID": "AVD-AWS-0164",
          "Title": "Instances in a subnet should not receive a public IP address by default.",
          "Description": "You should limit the provision of public IP addresses for resources. Resources should not be exposed on the public internet, but should have access limited to consumers required for the function of your application.",
          "Message": "Subnet associates public IP address.",
          "Query": "data..",
          "Resolution": "Set the instance to not be publicly accessible",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0164",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-instance-addressing.html#concepts-public-addresses",
            "https://avd.aquasec.com/misconfig/avd-aws-0164"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "EC2Subnet",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 76,
            "EndLine": 76,
            "Code": {
              "Lines": [
                {
                  "Number": 71,
                  "Content": "  EC2Subnet:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;33mEC2Subnet\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 72,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 76,
                  "Content": "      MapPublicIpOnLaunch: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mMapPublicIpOnLaunch\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 88,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 89,
                  "Content": "        Key: \"Name\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mKey\u001b[0m: \u001b[38;5;37m\"Name\"",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "EC2Subnet",
                "Filename": "lab4-template-1764886068528.yaml",
                "Location": {
                  "StartLine": 71,
                  "EndLine": 89
                }
              }
            ]
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0164",
          "AVDID": "AVD-AWS-0164",
          "Title": "Instances in a subnet should not receive a public IP address by default.",
          "Description": "You should limit the provision of public IP addresses for resources. Resources should not be exposed on the public internet, but should have access limited to consumers required for the function of your application.",
          "Message": "Subnet associates public IP address.",
          "Query": "data..",
          "Resolution": "Set the instance to not be publicly accessible",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0164",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-instance-addressing.html#concepts-public-addresses",
            "https://avd.aquasec.com/misconfig/avd-aws-0164"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "EC2SubnetSm",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 352,
            "EndLine": 352,
            "Code": {
              "Lines": [
                {
                  "Number": 347,
                  "Content": "  EC2SubnetSm:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;33mEC2SubnetSm\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 348,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 352,
                  "Content": "      MapPublicIpOnLaunch: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mMapPublicIpOnLaunch\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 364,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 365,
                  "Content": "        Key: \"Name\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mKey\u001b[0m: \u001b[38;5;37m\"Name\"",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "EC2SubnetSm",
                "Filename": "lab4-template-1764886068528.yaml",
                "Location": {
                  "StartLine": 347,
                  "EndLine": 365
                }
              }
            ]
          }
        }
      ]
    }
  ]
}
